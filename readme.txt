from https://gist.github.com/JakeWharton/1126843  modified